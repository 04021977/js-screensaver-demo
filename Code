<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Screensaver JS - Quadrados</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      cursor: none; /* opcional: esconder cursor em modo inativo */
    }

    #controls {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.6);
      padding: 10px;
      border-radius: 8px;
      z-index: 10;
      font-size: 14px;
      transition: opacity 0.3s ease; /* fade */
    }

    #controls.hidden {
      opacity: 0;
      pointer-events: none;
    }

    #controls label {
      display: block;
      margin-bottom: 6px;
    }

    #controls input[type="range"] {
      width: 180px;
    }

    .box {
      position: absolute;
      will-change: transform;
    }
  </style>
</head>
<body>

  <div id="controls">
    <label>
      Velocidade global:
      <input type="range" id="speedGlobal" min="0.2" max="3" step="0.1" value="1">
    </label>
    <label>
      Tamanho global:
      <input type="range" id="sizeGlobal" min="20" max="120" step="5" value="50">
    </label>
    <label>
      Saturação cor:
      <input type="range" id="satGlobal" min="20" max="100" step="5" value="80">
    </label>
  </div>

  <script>
    const boxes = [];
    const numBoxes = 8;

    const speedGlobalInput = document.getElementById('speedGlobal');
    const sizeGlobalInput = document.getElementById('sizeGlobal');
    const satGlobalInput   = document.getElementById('satGlobal');
    const controls = document.getElementById('controls');

    const vw = () => window.innerWidth;
    const vh = () => window.innerHeight;

    // ----- criação dos quadrados -----
    function createBox() {
      const div = document.createElement('div');
      div.className = 'box';

      const hue = Math.floor(Math.random() * 360);
      div.dataset.hue = hue;

      document.body.appendChild(div);

      const size = 50;
      const x = Math.random() * (vw() - size);
      const y = Math.random() * (vh() - size);

      const dirX = Math.random() > 0.5 ? 1 : -1;
      const dirY = Math.random() > 0.5 ? 1 : -1;

      const speed = 1 + Math.random() * 2;

      const box = {
        el: div,
        x,
        y,
        dirX,
        dirY,
        speed,
      };

      boxes.push(box);
    }

    for (let i = 0; i < numBoxes; i++) {
      createBox();
    }

    // ----- animação -----
    function update() {
      const speedFactor = parseFloat(speedGlobalInput.value);
      const sizeGlobal = parseFloat(sizeGlobalInput.value);
      const sat = parseFloat(satGlobalInput.value);

      const maxX = vw();
      const maxY = vh();

      for (const box of boxes) {
        const size = sizeGlobal;

        box.x += box.dirX * box.speed * speedFactor;
        box.y += box.dirY * box.speed * speedFactor;

        if (box.x <= 0) {
          box.x = 0;
          box.dirX = 1;
        } else if (box.x + size >= maxX) {
          box.x = maxX - size;
          box.dirX = -1;
        }

        if (box.y <= 0) {
          box.y = 0;
          box.dirY = 1;
        } else if (box.y + size >= maxY) {
          box.y = maxY - size;
          box.dirY = -1;
        }

        const hue = box.el.dataset.hue;
        box.el.style.width = size + 'px';
        box.el.style.height = size + 'px';
        box.el.style.backgroundColor = `hsl(${hue}, ${sat}%, 50%)`;
        box.el.style.borderRadius = '8px';
        box.el.style.transform = `translate(${box.x}px, ${box.y}px)`;
      }

      requestAnimationFrame(update);
    }

    update();

    // ----- lógica de inatividade (esconder/mostrar controles) -----
    let inactivityTimeout;
    const INACTIVITY_DELAY = 3000; // ms sem interação para esconder

    function showControls() {
      controls.classList.remove('hidden');
      document.body.style.cursor = 'default';
    }

    function hideControls() {
      controls.classList.add('hidden');
      document.body.style.cursor = 'none'; // estilo screensaver
    }

    function resetInactivityTimer() {
      showControls();
      clearTimeout(inactivityTimeout);
      inactivityTimeout = setTimeout(hideControls, INACTIVITY_DELAY);
    }

    // eventos que “acordam” o screensaver (mostram controles)
    ['mousemove', 'mousedown', 'keydown', 'touchstart'].forEach(eventName => {
      window.addEventListener(eventName, resetInactivityTimer);
    });

    // inicia timer ao carregar
    resetInactivityTimer();
  </script>
</body>
</html>
